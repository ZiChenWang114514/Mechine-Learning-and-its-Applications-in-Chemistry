# tICA

这段摘要是关于一种称为Metadynamics的增强型分子动力学采样方法。以下是对摘要内容的翻译和解释：

### 摘要翻译

#### **摘要**

Metadynamics是一种强大的增强型分子动力学采样方法，它通过在选定的集体变量（Collective Variables, CVs）上添加依赖于历史的多维高斯分布来加速模拟。在实际应用中，由于生物物理系统的高维特性，选择少量的缓变集体变量仍然是一个挑战。在这里，我们展示了时间结构基于独立成分分析（time-structure based independent component analysis, tICA），这是马尔可夫状态模型文献中的一项最新进展，它可以用来识别一组变分上最优的缓变坐标，用作Metadynamics中的集体变量。我们展示了线性和非线性的tICA-Metadynamics可以补充现有的分子动力学研究，通过明确采样系统最慢模式并且即使在无偏模拟中没有观察到这样的转变，也能沿着最慢模式驱动转变。

### 解释

1. **Metadynamics**: 这是一种增强型分子动力学方法，用于加速模拟。它通过在所谓的集体变量（CVs）上添加多维高斯分布来实现，这些高斯分布随着模拟的进展而改变，从而帮助探索能量景观的不同区域。

2. **集体变量的选择挑战**: 对于具有高维特征的生物物理系统，选择少量重要的、变化缓慢的集体变量（缓变CVs）是一个挑战。

3. **tICA的应用**: 时间结构基于独立成分分析（tICA）是一种用于识别缓变坐标的方法。这些坐标在变分上是最优的，意味着它们是系统动态中最重要的部分。

4. **tICA-Metadynamics的优势**: 该研究表明，无论是线性还是非线性的tICA-Metadynamics都能有效地补充现有的分子动力学研究。它们通过明确采样系统中最慢的模式，能够在未经偏置的模拟中观察到的模式之外，驱动新的转变。

这篇摘要提出了一种新的方法来增强和加速分子动力学模拟，特别是在处理复杂的生物物理系统时。通过结合tICA和Metadynamics，研究人员可以更有效地探索这些系统的重要动态特征。

这段引言部分介绍了分子动力学（MD）在探索蛋白质自由能景观和理解复杂生物物理过程方面的应用，以及Metadynamics和马尔可夫状态模型（MSM）的融合应用。以下是对这段引言的翻译和解释：

### 引言翻译

#### **引言**

分子动力学（MD）是一种强大的计算方法，用于探索蛋白质的自由能景观，提供关于复杂生物物理过程的结构、动力学和热力学洞见。然而，由于生物过程常常涉及毫秒或更长的时间尺度，MD通常会遭遇收敛性问题。尽管算法改进、使用较短的轨迹、专用硬件和GPU技术在一定程度上缓解了这一问题，但获得生物学上有趣的过程和时间尺度的常规访问仍然是禁止性的。为了提高效率，研究人员开发了各种增强采样方法。Metadynamics是这样一种方法，它通过在轨迹历史中局部最小值处添加正高斯势，将系统“推出”自由能盆地。Metadynamics已成功用于理解各种生物物理过程，可以被视为计算上的“填沙”过程。然而，Metadynamics需要识别分子描述符或集体变量（CVs），如何选择这些CVs以代表蛋白质复杂状态空间并不立即明确。研究人员还利用成百上千个短时（10-100纳秒）无偏MD轨迹的信息，转向马尔可夫状态模型（MSMs），这些模型参数化了一个动力学主方程，其谱分解提供了关于系统慢动力学的洞见。MSMs仅要求每个状态的局部动力学平衡，使得MD模拟的并行化变得容易。目前，MSM的构建涉及将蛋白质可访问的相空间划分为一组不重叠的状态，并计算它们之间的转换。这些状态可以沿着通过tICA方法获得的一组简化坐标来动力学定义。tICA是一种降维方法，旨在将MD数据嵌入到一个较低维度的子空间中，同时最小化动力学信息的损失。它通过寻找数据集中最慢的变量来实现这一目标。在本文中，我们提出将Metadynamics与当前MSM方法相结合的想法。特别是，我们利用tICA方法找到缓慢衰减的变量，直接用作Metadynamics中的CVs。使用tICA特征向量（tICs）既可以补充无偏MD采样，也可以沿其最慢反应坐标驱动轨迹。为此，我们首先重申一组“好”的CVs所具备的属性。然后我们展示这些属性是由转移算子的主要特征向量满足的，该转移算子通过tICA和MSMs的各种形式近似。我们通过展示模型系统的结果来结束。MSMs最近也被用来提高伞形采样计算的收敛性，而且使用机器学习（ML）结合MD轨迹来构建CVs并不是新鲜事。之前的工作包括使用主成分分析（PCA）、Isomaps和Sketch maps。这

些是降维技术，旨在通过最小化某些目标函数，将高维MD数据嵌入到较低维度的子空间中。较低维度的坐标因为固有地包含更多信息而提供了更优越的CVs，例如在PCA的情况下，包括了大规模振幅运动的信息。然而，与tICA不同，这些ML方法既没有使用轨迹中包含的时间信息，也没有能力直接从数据中找到慢坐标。此外，使用不同内部参数的解决方案并不一定相互可比。例如，使用系统的二面角构建的主成分/正常模式是否能比使用接触距离构建的更好地描述慢动力学？为什么或如何这些降维能够描述系统的慢动力学？相比之下，结合统计交叉验证的tICA和MSM分析的最近开发的变分界限允许建模者在MD轨迹数据集中定量比较tICA和MSMs的优势，可能整合了大量的建模选择。

### 解释

这段引言强调了分子动力学在生物物理学中的应用，特别是在探索蛋白质自由能景观方面。但由于其时间尺度的限制，MD模拟经常面临收敛问题。为了克服这一挑战，研究人员开发了增强采样技术，如Metadynamics和马尔可夫状态模型（MSMs）。Metadynamics通过在能量景观的局部最小值处添加高斯势能来“推动”系统，而MSMs通过分析短时MD轨迹来洞察系统的慢动力学。

文章的主要创新点在于将tICA（时间结构独立成分分析）与Metadynamics和MSMs相结合。tICA是一种降维方法，用于从MD数据中找到最慢的动力学变量。这些变量（tICs）可以用作Metadynamics的集体变量，提高采样效率，并揭示系统的慢速反应坐标。

此外，引言还讨论了如PCA和Isomaps等其他机器学习方法在降维和提取集体变量方面的应用，但指出这些方法不像tICA那样有效，因为它们不考虑时间信息或直接从数据中找到慢速坐标。最后，作者提出了使用tICA和MSMs的变分界限和统计交叉验证来比较不同方法的有效性。

这项工作的意义在于，它提出了一种更有效的方法来识别和利用分子动力学中的关键动力学变量，从而更好地理解和模拟生物物理系统的复杂动态。



这部分讨论了如何使用tICA方法为Metadynamics提供缓慢变化的集体变量（CVs）。以下是对这部分内容的翻译和解释：

### 翻译

#### **tICA解决方案为Metadynamics提供缓慢的CVs**

虽然任何定义良好的单维或多维CV都有相应的自由能函数，但任何增强采样算法的CVs理想情况下应与系统的慢动力学相关。换句话说，CVs应能够识别全相空间中亚稳态之间的转变。在Abrahms等人和Laio等人的研究中，他们认为一组好的CVs应该代表从全相空间$\Omega$到一小组实数$\mathbb{R}$的降维。CVs还应能够描述所有相关的慢事件，以及区分开始、结束和中间状态。

在McGibbon等人的研究中，这些属性被编码为自然反应坐标的定义。他们认为，自然反应坐标a)是一种降维，b)是从动力学中学习的，c)是对未来演化的最大预测性。然后他们展示了这些属性被系统马尔可夫动力学中的主要特征函数$\psi$满足。第一个特征函数对应于平衡分布，与我们的讨论无关。然而，第二个特征函数$\psi_2$是系统最“缓慢衰减的集体变量”，并且最大限度地预测其未来动力学。这种形式主义非常适合于自动选择Metadynamics的缓慢衰减CVs，剩下的就是找到近似主要特征函数/特征向量的方法。MSM和ICA是两种旨在近似这些特征向量的方法，尽管它们选择的基不同。

tICA是一种基于动力学的技术，旨在通过最大化自相关函数来找到数据中最小化动力学信息损失的投影。记住，高自相关值意味着更慢的结构自由度。在tICA中，我们寻求通过找到在特定滞后时间最慢衰减的输入结构顺序参数的线性组合来近似$\psi_2$。这些顺序参数可以是所有的主链或侧链二面角或接触距离等。tICA形式主义的完整推导超出了本文的范围，但我们使用参考文献15中的符号简要描述它。关于tICA与转移算子的联系的更完整推导，我们将读者引用到之前的工作。

设$\left\{\chi_t^d\right\}_{t=0}^{N_t-1}$是一个多维MD时间序列，其中每个帧通过一个d维的列来表示一个系统。我们进一步假设数据的均值为0。然后，tICA寻求最大化以下函数：

$$
f\left(\left|a_1\right\rangle\right)=\frac{\mathbb{E}\left[\left\langle a_1 \mid \chi_t\right\rangle\left\langle a_1 \mid \chi_{t+\Delta t}\right\rangle\right]}{\mathbb{E}\left[\left\langle a_1 \mid \chi_t\right\rangle\left\langle a_1 \mid \chi_t\right\rangle\right]}
$$
其中，最大化是在数据投影到$a_1$的自相关函数上进行的。通过利用内积对称性，可以展示：

$$
f\left(\left|a_1\right\rangle\right)=\frac{\left\langle a_1|C(\Delta t)| a_1\right\rangle}{\left\langle a_1|\Sigma| a_1\right\rangle}
$$
这里，对称矩阵$C(\Delta t)$是基函数之间的时间滞后相关：

$$
C_{i j}(\Delta t)=\mathbb{E}\left[\chi_t^i \cdot \chi_{t+\Delta t}^j\right]
$$
而$\Sigma$是基函数的正定协方差矩阵：

$$
\Sigma_{i j}=\mathbb{E}\left[\chi_t^i \cdot \chi_t^j\right]
$$
在应用单位方差约束并设置一个通过Langrage乘子可解的优化问题后，可以展示$a_1$（也是最接近$\psi_2$的线性近似）是广义特征值问题的解：

$$
C(\Delta t)\left|a_1\right\rangle=\lambda_1 \Sigma\left|a_1\right\rangle
$$

随后的投影，$a_2 \ldots a_d$，可以通过要求$a_n$解与之前的所有解不相关来类似地找到。上述形式主义的一个吸引人的特性是，它推广到多个正交反应坐标（tICs），按时间尺度递减排序。这一特性可以被利用来防止由于“隐藏”的正交自由度而导致的缓慢收敛，通过同时采样多个tICs，并通过复制交换将它们连接起来。这意味着如果我们加速前“m”个tICs，每个tICs加速X-ns，使得X大于下一个（m+1）tIC的时间尺度，那么系统将自然平衡并采样那些额外的自由度。

### 特殊名词解释

1. **集体变量（CVs）**: 在分子动力学中，用于描述系统宏观行为的一组参数或坐标。
2. **tICA（时间结构独立成分分析）**: 一种基于动力学的降维技术，用于从复杂的分子动力学数据中提取出最慢变化的变量。
3. **自相关函数**: 用于测量时间序列中不同时间点的值之间的相关性的统计量。
4. **马尔可夫动力学**: 一种随机过程，其中系统的未来状态只依赖于其当前状态，而与过去状态无关。
5. **特征函数/特征向量**: 在数学中，特征函数是描述系统状态的函数，特征向量则是在线性代数中描述矩阵行为的向量。
6. **Langrage乘子**: 一种在优化问题中处理约束条件的数学方法。
7. **复制交换**: 一种用于增强采样效率的计算方法，通过在不同模拟副本之间交换配置信息。

这部分内容描述了如何在实践中找到最慢的tICA组分（tICs）的具体步骤，并引入了使用Metadynamics直接采样慢速自由度的新步骤。以下是对这部分内容的翻译和解释：

### 翻译

#### **在实践中找到最慢的tICA组分**

实际上，找到一组最慢的tICA组分（tICs）需要以下步骤：

1. 从所有可用的晶体结构或同源模型开始运行一些MD模拟。
2. 选择一组相关的结构顺序参数（例如所有的二面角或接触点，或它们的某种组合），以表示轨迹的每一帧。特征的选择依然有待确定，但ICA可以轻松处理成百上千的顺序参数，我们可以通过交叉验证根据可用数据选择最佳特征集。
3. 在选择tICA滞后时间$\Delta t$后，计算对称矩阵$C(\Delta t)$和正定矩阵$\Sigma$。从经验上看，我们发现ICA对于在$1-100$纳秒范围内的选择是稳健的，尽管这个参数可以自动选择。
4. 解方程$C(\Delta t) \cdot a = \lambda \Sigma \cdot a$。
5. 选择具有最大特征值的前几个特征向量（tICs）。

之前，tICA方法被用作MSM构建中的一个中间降维步骤。在此，我们在上述步骤中增加了一个最终步骤。

6. 使用Metadynamics直接采样慢速自由度，通过将tICs用作CVs。

这类似于使用主成分（PCs），但更有优势，因为我们不隐含地假设慢速自由度与高方差相关。

这可能发生在高方差模式可能是在自由能盆地内的运动（参见补充信息中的图1，对tICA与PCA在丙氨酸上的比较），而不是它们之间的运动。我们还指出，我们的方法在精神上与Tiwary等人的谱间隙最大化工作类似，尽管我们提出了一个更简单的CV优化策略，可以处理更大和更多样化的特征输入，通过对内核技巧的地标近似和Bias-Exchange进行真实的扩展。

### 解释

在实践中，这种方法涉及通过MD模拟和选择结构顺序参数来构建数据集，然后使用tICA分析这些数据以识别系统的慢速动力学坐标。这些坐标（tICs）随后被用作Metadynamics的集体变量，以直接采样系统的慢速自由度。这种方法的优势在于它不假设慢速自由度与高方差相关，这在某些情况下可能不是真实的。

图1展示了tICA-Metadynamics对丙氨酸二肽的应用，说明了这种方法如何帮助收敛模拟，特别是在只观察到少数慢速转换的情况下。通过比较tICA和传统方法（如PCA），该图显示了tICA在识别和采样慢速动力学坐标方面的优势。

这部分内容讨论了tICA-Metadynamics在丙氨酸二肽模型上的应用，以及它是如何加速模拟并沿着最慢模式实现快速混合的。以下是对这部分内容的翻译和解释：

### 翻译

#### **在丙氨酸二肽上应用tICA-Metadynamics实现沿最慢模式的快速混合**

我们通过使用溶解的丙氨酸二肽和牛胰蛋白酶抑制剂（BPTI）的简单例子来结束这篇论文。丙氨酸二肽曾作为一个有趣的模型系统在Metadynamics中被使用，因为选择较快的CV $\psi$ 导致滞后和模拟收敛缓慢。在这里，我们展示了不仅主要的独立成分能够找到一个慢坐标，而且它是以无偏见的方式做到这一点的。

所有MD轨迹都是在NPT系综中生成的，使用MonteCarlo Barostat（1大气压），Langevin积分器（300 K），以及2 fs的时间步长。长程电静力学使用PME方法进行模拟。蛋白质动力学使用Amber99sb-ildn模型和Tip3P水模型进行模拟。所有模拟，包括Metadynamics运行，都是从相同的初始坐标和速度开始的，并在使用OpenMM和Plumed的GPU上进行。对于所有Metadynamics运行，我们限制采样仅至主要（最慢）的tIC，除非另有说明。高斯每2 ps放置一次，高度为0.2 kJ/mol，宽度为0.1（任意tIC单位）。我们还运行了其他轨迹，在其中增加了高斯的宽度和高度，但发现结果是可比的。所有IICA模型都是使用丙氨酸二肽的主链phi和psi二面角的正弦余弦变换，在tICA滞后时间为1 ns处构建的。所有MSMs都是在tICA滞后时间为1 ns后，将数据聚类为50个状态，并沿主导tIC构建的。我们使用MDTraj和MSMBuilder3来构建所有tICA、聚类和马尔可夫状态模型。我们使用pyEMMA进行MBAR和WHAM计算。

我们首先生成了一条170 ns的MD轨迹，并构建了一个tICA模型来识别系统内的慢动力学（图1a-c）。我们的结果表明，最慢的转变发生在大约50-75 ns，并对应于从$\beta / \alpha_R$ 盆地到$\alpha_L$ 盆地的运动（图1a）。这种运动涉及沿较快的$\psi$和较慢的$\phi$坐标的转变（图1c）。在无偏MD模拟中，我们观察到仅有两次这样的转变（图1b），导致热力学中存在较大的统计不确定性（图1f，青色曲线）。为了补充这种无偏MD模拟，我们使用Metadynamics采样tIC（从相同的初始坐标和速度开始）。在15 ns的过程中，我们能够见证同样的转变发生了几十次，为两个盆地（$\alpha_L$ vs $\alpha_R$ 和 $\beta$）的稳健自由能估计提供了基础。例如，我们的模拟在15 ns的过程中185次访问了$\alpha_L$ 盆地

（tIC值>5），相比之下，在170 ns的传统MD中仅两次，呈现出接近1000倍的潜在加速。值得注意的是，当我们将常规MD模拟扩展到总计1800 ns时（图1f，金色曲线），MSM和tICA-Metadynamics之间的自由能差异降至不到1 kcal/mol，表明这两种技术之间存在协同机会。

### 解释

这部分内容说明了如何使用tICA-Metadynamics在丙氨酸二肽上实现快速混合，并沿着系统的最慢模式加速模拟。通过与无偏MD模拟相结合，tICA-Metadynamics能够更频繁地观察到系统状态之间的转变，从而提高了自由能估计的稳健性。结果表明，这种方法能够显著加快模拟速度，同时与传统的MD模拟和MSM方法相结合，提供了更全面和准确的系统动力学和热力学分析。

![image-20231221195317658](C:\Users\11234\AppData\Roaming\Typora\typora-user-images\image-20231221195317658.png)

图1. tICA-Metadynamics对丙氨酸二肽有助于收敛模拟，在其中仅观察到少数慢转换。从顶部顺时针方向a）根据每一帧投影到主导tIC（任意单位）的Ramachandran图。主导tIC对应于沿$(\psi)$和$(\phi)$的运动。大的黄色圆圈代表本文中所有模拟的起始帧。b）沿主导tIC的轨迹投影显示了在约75和约120纳秒处的两个慢转换。c）根据每个输入特征的加载量分解主导tIC。更高的值表示对最慢坐标的更大贡献。参见补充信息中的图1与PCA进行比较。d）使用（a）投影的15纳秒Metadynamics运行。e）将Metadynamics模拟投影到tIC上显示快速混合。f）比较MD（170和1800纳秒）与tICA-Metadynamics方法的蛋白质热力学。浅红色曲线表示每2000个高斯后的自由能面估计。

这部分内容探讨了在没有观察到慢速转换的数据中，如何使用tICA-Metadynamics方法来驱动沿最慢模式的转换。以下是对这部分内容的翻译和解释：

### 翻译

#### **在丙氨酸二肽上应用tICA-Metadynamics可以驱动沿最慢模式的转换**

我们接下来研究了当数据中没有发生慢速转换，但tICA模型能够部分近似模拟中的真实时间滞后相关矩阵和协方差矩阵时，是否可以使用tICAMetadynamics方法。这是合理的，因为当我们不包括稀有交叉区域在相关计算中时，只有少数数据点会丢失。我们还注意到，这是MD模拟中的一个常见问题，其中建模者可以访问多个起始晶体结构，但自由能差异、连接这些状态的最低自由能路径或中间态或偏离路径状态的知识仍然难以捉摸。例如，在丙氨酸二肽的情况下，这将指的是从$\beta / \alpha_R$到$\alpha_L$盆地的转换（图lac），主要由缓慢演化的$\phi$二面角主导。

为了测试我们的假设，我们从常规的长时间模拟中切割了两个约2 ns（原始170 ns的2.5%）的轨迹，注意避免在$\beta$和$\alpha_L$盆地之间发生任何交叉（图2a-c）。接下来，我们训练了一个新的tICA模型（图2c，部分MD tICA）。同样，主要的tIC对应于进出$\alpha_L$盆地的转换，尽管相关的时间尺度现在没有意义。更重要的是，当我们沿这个坐标进行Metadynamics时，我们的模拟能够从$\beta$盆地过渡到$\alpha_L$盆地。由于模拟的长度，我们的轨迹自然地发现了与$\beta$区域相隔较小障碍的$\alpha_R$盆地。我们在约15 ns的模拟中获得了沿主要模式的大约10 s的交叉。例如，我们的模拟在15 ns的过程中122次访问了$\alpha_L$盆地（定义为IC值>0.6），与训练数据中4 ns的零次访问形成鲜明对比。

### 解释

这部分内容展示了tICA-Metadynamics方法如何在没有观察到慢速转换的情况下，通过模拟驱动丙氨酸二肽沿最慢模式的转换。通过对常规模拟中的一小部分轨迹进行分析和Metadynamics采样，研究者能够发现并采样到之前未被观察到的转换。这种方法证明了即使在数据中缺乏直接观测到的慢速转换，Metadynamics也可以有效地促进系统沿其最慢坐标的探索。图2展示了这种方法在丙氨酸二肽上的应用，以及它如何实现更快的混合和更准确的热力学估计。

![image-20231221195430872](C:\Users\11234\AppData\Roaming\Typora\typora-user-images\image-20231221195430872.png)

图2. tICA-Metadynamics即使在tICA训练数据中没有观察到转换，也可以驱动丙氨酸二肽模拟沿慢坐标。从顶部顺时针方向a）根据每一帧投影到新tICA模型（该模型基于切割轨迹数据训练）的图1a中轨迹的子部分的Ramachandran图。主导tIC对应于沿$(\psi)$和$(\phi)$的运动。b）沿主导tIC的轨迹投影显示在4 ns的模拟中没有前进或后退的转换。c）根据每个输入特征的加载量分解主导tIC。d）使用（a）投影的15 ns Metadynamics运行。e）将Metadynamics模拟投影到部分MD tIC坐标上显示快速混合。f）比较部分MD与tICAMetadynamics方法的蛋白质热力学。浅红色曲线表示每2000个高斯后的自由能面估计。我们明确指出，这是一个新的tICA模型，不应与图1中的模型进行数值比较。



这部分内容讨论了如何通过利用非线性和偏见交换将tICA-Metadynamics扩展到多个坐标。以下是对这部分内容的翻译和解释：

### 翻译

#### **通过利用非线性和偏见交换扩展tICA-Metadynamics至多个坐标**

对于更大、更复杂的生物物理系统，可能没有单一的线性输入特征组合能够很好地近似系统的最慢动力学。这是大多数基于CV的增强采样算法中的一个通用问题，通常通过使用替代的或多个CVs来解决。相比之下，我们提出使用核技巧显著提高tICA估计转移算子特征函数的能力。

核方法是机器学习领域的算法。在这些方法中，输入特征被隐式地扩展到更高维度空间。这是通过计算所有数据对之间的内积来完成的。在我们的案例中，这种非线性变换后接着是线性ICA，使我们的最终解决方案成为非线性函数的线性组合。最常用的核是高斯核：
$$
k(x, y)=e^{-\|x-y\|^2 / 2 \sigma^2}
$$

其中$x$和$y$是两种蛋白质构象，$\sigma$是一个依赖于所选择的距离度量的用户参数。因此，我们系统中最慢的坐标是指数距离的线性组合，这些距离衰减最慢。在这里，指数函数隐含地编码了非线性行为。完整的核操作要求我们计算任何新生成的构象与所有之前生成的训练数据点的距离。从经验上看，我们发现完整的核-tICA解决方案过于拖慢了我们的Metadynamics模拟，因此我们被迫使用地标近似。在这种情况下，核$k(x, y)$只为无偏MD数据集中预先选定的一组地标构象计算。

为了测试地标核-tICA-Metadynamics模拟协议，我们选择了Shaw等人在Anton机器上进行的58残基蛋白BPTI的毫秒级长模拟。在他们的模拟中，除了约800微秒时发生的大规模构象变化外，BPTI在1毫秒的模拟过程中保持稳定。这种高自由能状态对应于蛋白质核心的开放和水合。我们测试了地标核-tICA是否能找到一个坐标，Metadynamics可以加速这种开放和关闭的过程。作为一个旁注，我们还测试了tICA是否能够在不需要全采样的情况下，仅通过使用开放和关闭状态的数据来找到主要IC坐标的近似值，发现ICA可以使用各种输入特征区分盆地。

在对BPTI的实验中，原始Anton轨迹被子采样至25纳秒以便更快的分析。我们使用了50个地标点（通过选择50个状态聚类模型的质心来挑选），结合了所有原子的RMSD距离度量和0.3纳米的$\sigma$值。值得注意的是，所有原子RMSD地标核ICA解决方案在全相空间中运行，不受传统选定CVs困扰的许多问题的影响。与之前的工作类似，我们的IICA实验中使用其他ICA参数和距离度量发现了动力学断开的

数据集，表明在进行ICA-Metadynamics之前需要验证ICA模型。我们认为这可能是力场或采样的伪迹，选择专注于正确描述蛋白质核心开放的所有原子RMSD度量的结果。ICA模型是在100纳秒（4帧）的滞后时间内使用所有可用数据和动力学映射缩放构建的。我们将数据投影到前五个慢模式上（图3a-b）。

将整个1毫秒的Anton模拟投影到五个tICs上的结果显示在图3b中。非线性地标核tICA模型捕捉到了蛋白质的大规模构象变化（图3d），在图3b的顶部面板中，从低到高值变化。我们决定通过在五个tICA坐标上进行偏见交换良好调温的Metadynamics来加速采样这一过程。在良好调温的Metadynamics中，随着模拟的进行，高斯高度被缩放，从而导致平滑收敛的自由能轮廓。在偏见交换Metadynamics中，一次性加速多个坐标，并在设定的模拟时间根据蒙特卡洛标准交换坐标。

我们所有的BPTI模拟都是在NPT系综中使用Amber99sb-ildn蛋白模型和TIP3P水模型进行的。我们为每个复制运行了大约140纳秒，每6纳秒尝试一次交换。我们将高斯放置的频率设为每2纳秒一次，高度设为1千焦/摩尔，宽度设为0.2，偏见因子为1000。如图3c所示的第一个ICMetadynamics复制的结果，我们能够相当显著地加速BPTI的开放和关闭，捕获了许多核心开放事件。

对于更复杂的系统，核tICA可能还不够。例如，对于BPTI，仍有几个tIC坐标的交换时间尺度在几百纳秒的级别（图3a，索引>5）。鉴于我们轨迹的长度，我们的模拟可能没有充分采样这些维度（补充信息图3），我们将需要进一步延长Metadynamics模拟。在这种情况下，我们建议沿着所有tICA坐标加速系统，这些坐标的推断时间尺度大于任何单个复制的模拟长度。然后，这些轨迹可以使用加权直方图技术（WHAM）或多状态Bennett接受比（MBAR）重新加权到完整状态空间。这在希望估计在模拟中没有偏见的坐标上的自由能时非常有用。补充信息包含了一个丙氨酸二肽的例子，我们在其中使用非线性tICA结合偏见交换良好调温的Metadynamics来加速前两个慢模式，使用MBAR将轨迹重新加权到完整相空间，并将结果与几微秒的常规MD进行了比较。

总之，我们提出使用MSM文献中的tICA方法作为发现Metadynamics CVs（tICA-Metadynamics）的无偏见方式。这优于基于ML的或启发式工程，因为IICA在构建上试图找到输入结构顺序参数中衰减最慢的组合。我们进一步展示，即使在数据量低的情况下，tICA的近似解也能为Metadynamics提供CVs。

### 解释

这部分内容展示了如何通过在tICA-Metadynamics中引入非线性和偏见交换来处理更复杂的生物物理系统。这种方法特别适用于那些无单一线性特征组合能够充分捕捉系统最慢动力学的情况。通过使用核技巧，tICA能够更有效地估计转移算子的特征函数，从而提高了识别和采样系统慢动力学坐标的能力。

在核方法中，输入特征被隐式地扩展到更高维度的空间，使得最终解决方案成为非线性函数的线性组合。这种方法在处理复杂系统时更为有利，因为它能够捕捉更多的动力学信息，尤其是当传统的CV选择方法遇到困难时。

文章中以58残基蛋白BPTI的模拟为例，展示了如何使用地标核tICA-Metadynamics协议来加速蛋白质核心的开放和关闭过程。通过对Anton机器上运行的BPTI的毫秒级长模拟的分析，研究者能够识别出导致蛋白质结构大变化的坐标，并使用偏见交换良好调温的Metadynamics在这些坐标上进行加速采样。

这种方法不仅能加速模拟过程，还能提高自由能估计的准确性。通过在多个tICA坐标上同时进行加速，并在设定的模拟时间根据蒙特卡罗标准交换坐标，可以有效地探索多个动力学维度。这对于探索和理解复杂系统的动力学特性是非常有价值的。

此外，作者提到，在一些更为复杂的系统中，可能需要进一步延长Metadynamics模拟，并推荐在所有推断时间尺度大于任何单个模拟长度的tICA坐标上进行加速。这些轨迹可以使用加权直方图技术（WHAM）或多状态Bennett接受比（MBAR）进行重新加权，从而估计在模拟中未受偏见的坐标上的自由能。

总之，这篇论文提出了使用tICA作为发现Metadynamics集体变量的一种无偏见方法，这一方法在寻找输入结构顺序参数中衰减最慢的组合方面具有优势。即使在数据量较低的情况下，tICA的近似解也能为Metadynamics提供有效的集体变量。

这段内容讨论了tICA-Metadynamics方法的一些局限性，并提出了未来研究的可能方向。以下是对这部分内容的翻译和解释：

### 翻译

#### **tICA-Metadynamics的局限性**

值得注意的是，tICA-Metadynamics也有一些局限性。在我们希望补充MSM对热力学和动力学估计的例子中，我们需要通过MD进行无偏采样来捕获慢速转换。这可能需要几百微秒的MD采样总量，对于除了最小系统之外的所有系统来说都是不可行的。在不完整的MD情况下，我们希望沿最慢的tICs驱动转换，我们假设进行了足够的MD，从高和低自由能状态开始，使得ICA模型能够近似时间滞后相关函数。根据系统的不同，这可能非常困难；例如，可能无法正确排列一组最慢坐标的顺序。在这两种情况下，选择要加速的ICA坐标数量的问题仍然存在。虽然核扩展和同时沿多个坐标加速可以大大减轻这种情况，但收敛可能需要对所有交换时间尺度慢于各个模拟长度并通过复制方案相互耦合的tICA坐标进行采样。最后，我们本质上假设tICs是生物学上有意义的，而不是基础选择、采样和/或力场不准确性的伪迹。

在结束之前，我们指出，虽然我们将结果限制在改善Metadynamics模拟的CV选择上，但这种方法也可以用来为其他增强采样方法找到更好的CVs。例如，完全有可能直接使用Umbrella采样或其变体来采样这些tICs。也有可能将tICs与不同的恒温器结合起来，类似于加速温度的MD。后一种方法可能允许使用更多的tICs，尽管在这种情况下重构确切的自由能表面是一个未解决的问题。我们还指出，虽然我们使用了ICA的两种主要变体，但存在其他近似和改进，可能更适合tICA-Metadynamics。

重要的是，使用转移算子的主要特征向量作为CVs为未来研究开辟了有趣的途径。我们是否可以将完整的MSM状态空间作为Metadynamics的驱动力，从而完全整合出选择CVs的繁琐问题？核tICA示例部分解决了这个问题，但受到选择代表性地标坐标的需要的限制。在Metadynamics方面，是否拥有MSM自由能景观的部分或完整知识有助于加速收敛或减少研究者自由度，如高斯宽度、形状和放置速率？我们是否可以使用粗粒化模拟的ICA坐标进行原子级模拟，或反之亦然？我们预期这些问题可能为将反应坐标基础方法与增强采样算法直接耦合提供有趣的研究途径。



![image-20231221195440879](C:\Users\11234\AppData\Roaming\Typora\typora-user-images\image-20231221195440879.png)

图3. 加速BPTI沿其慢模式使得蛋白质核心的开放和关闭能够高效采样。a）非线性tICA模型推断的交换时间尺度。我们限制了Metadynamics采样到前5种模式（虚线）。b）将1毫秒的Anton轨迹投影到

前5种模式上。起始处的水平标记对应于作为地标坐标的50个pdb的投影。蛋白质核心的开放对应于约800微秒标记处的大规模运动。c）其中一个Metadynamics轨迹的140纳秒投影，显示通过使用非线性IICA和偏见交换可以重复采样这一运动。d）第一个tIC主要对应于N端环的外向运动的图片表示。蛋白质图像是使用VMD生成的，二级结构是使用STRIDE分配的，图表是使用Matplotlib、IPython、MSMBuilder和MSMExplorer制作的。

### 解释

这部分内容强调了tICA-Metadynamics在处理复杂系统时的局限性，特别是在需要大量MD采样来捕获慢速转换的情况下。此外，它提出了在选择加速的ICA坐标数量上存在的挑战，以及在进行tICA-Metadynamics时可能遇到的问题，如基础选择、采样和力场准确性。

尽管存在这些局限性，作者也提出了tICA-Metadynamics方法未来的研究方向，例如将完整的MSM状态空间作为Metadynamics的驱动力，或者将粗粒化模拟的ICA坐标用于原子级模拟。这些探索可能为将反应坐标基础方法与增强采样算法直接耦合提供新的研究途径。

总体而言，尽管tICA-Metadynamics方法在处理复杂系统时面临一些挑战和局限性，但它仍然提供了一种有价值的方法来探索和理解复杂生物物理系统的动力学和热力学特性，并为未来的研究提供了新的方向。

