1. ##### ABSTRACT

Metadynamics is a powerful enhanced molecular dynamics sampling method that accelerates simulations by adding history-dependent multidimensional Gaussians along selective collective variables (CVs). In practice, choosing a small number of slow CVs remains challenging due to the inherent high dimensionality of biophysical systems. Here we show that time-structure based independent component analysis (tICA), a recent advance in Markov state model literature, can be used to identify a set of variationally optimal slow coordinates for use as CVs for Metadynamics. We show that linear and nonlinear tICA-Metadynamics can complement existing MD studies by explicitly sampling the system’s slowest modes and can even drive transitions along the slowest modes even when no such transitions are observed in unbiased simulations.

2. ##### INTRODUCTION

Molecular dynamics (MD) is a powerful computational method used to explore protein free energy landscapes that provides structural, kinetic, and thermodynamic insights into complex biophysical processes.1 However, due to the millisecond or greater time scales of biological processes, MD often, if not always, suffers from lack of convergence issues. While algorithmic improvements, use of smaller trajectories,2 dedicated hardware,3,4 and GPU5,6 technologies have alleviated the problem, routine access to biologically interesting processes and time scales remains prohibitive to all but a few.3,7 To improve efficiency, researchers have developed a variety of enhanced sampling methods. Metadynamics8−12 is one such method that “pushes” a system out of free energy basins by adding positive Gaussian potentials at local minima in the trajectory history. Metadynamics has been successfully used to understand various biophysical13 processes and can be thought of as computational sand filling.14 However, Metadynamics requires the identification of molecular descriptors or collective variables (CVs), and it is not immediately clear how the CVs should be chosen such that they are representative of a protein’s complex state space. Researchers have also leveraged information from hundreds of short (10−100s of ns) unbiased MD trajectories by turning to Markov state models2 (MSMs), which parametrize a kinetic master equation whose spectral decomposition provides insight into the slow dynamics of a system. MSMs require only local equilibrium within the dynamics of each state, enabling trivial parallelization of the MD simulations. Currently, MSM construction involves partitioning of the proteins’ accessible phase space into a set of nonoverlapping states and counting the transitions between them. The states can be kinetically defined along a reduced set of coordinates obtained via the tICA15,16 method. tICA is a dimensionality reduction method that seeks to embed MD data into a lower dimensional subspace while minimizing the loss of kinetic information. It does this by finding the slowest variables within the data set. In this paper, we propose combining ideas from Metadynamics with current MSM methods. In particular, we leverage the tICA15−18 method to find slowly decorrelating variables for direct use as CVs in Metadynamics. The use of tICA eigenvectors (tICs) can be used either to complement unbiased MD sampling or to drive trajectories along their slowest reaction coordinates. To this end, we first restate what properties a “good” set of CVs poses. We then show that these properties are satisfied by the dominant eigenvectors of the transfer operator, which is approximated in various forms via both tICA15−18 and MSMs. We conclude by demonstrating results for model systems. MSMs have also been recently employed to improve convergence19 of umbrella sampling20 calculations, and using machine learning (ML) in combination with MD trajectories to build CVs is not new.21−24 Previous work involved using Principal component analysis (PCA), Isomaps, and Sketch maps. These are dimensionality reduction techniques that seek to embed high dimensional MD data into lower dimensional subspaces by minimizing certain objective functions. The lower dimensional coordinates arguably provide superior CVs because they inherently include more information regarding, for example, in the case of PCA, large scale amplitude motion. However, in contrast to tICA, these ML methods neither use the time information contained in trajectories, nor are they capable of finding slow coordinates directly from the data. Furthermore, solutions employing differing internal parameters are not necessarily comparable to one another. For example, are the principal components/normal modes built using the dihedrals of a system better capable of describing the slow dynamics than those built from contact distances? Why or how are such dimensionality reductions capable of describing the system’s slow dynamics? In contrast, a recently developed variational bound for tICA and MSM analysis25 in combination with statistical cross-validation26 allow modelers to quantitatively compare the goodness of tICA and MSMs across a MD trajectory data set, potentially integrating out a large set of modeling choices

3. ##### TICA SOLUTIONS PROVIDE SLOW CVS FOR METADYNAMICS

Although any well-defined single- or multidimensional CV has an associated free energy function, the $\mathrm{CVs}^{14}$ for any enhanced sampling algorithm should ideally correlate with the slow dynamics of the systems. In other words, CVs are expected to be capable of identifying the transitions between metastable states in full phase space. In Abrahms et al. ${ }^9$ and Laio et al., ${ }^{14}$ it was argued that a good set of CVs should represent a dimensionality reduction from the full phase space $\Omega$ to a small set of $\mathbb{R}$ numbers. CVs should also be able to describe all the relevant slow events as well as distinguish start, end, and intermediate states.

In McGibbon et al., ${ }^{18}$ these properties were codified under the definition of a natural reaction coordinate. They argued that a natural reaction coordinate a) is a dimensionality reduction $b$ ) is learned from the dynamics and c) is maximally predictive of future evolution. They then showed that these properties are satisfied by the leading eigenfunctions $(\psi)$ of the system's Markovian dynamics in $\Omega$. The first eigenfunction corresponds to the equilibrium distribution and is not relevant to our discussion. However, the second eigenfunction $\left(\psi_2\right)$ is the system's most "slowly decorrelating collective variable" and is maximally predictive of its future dynamics. This formalism is thus well suited to automatically choosing slowly decorrelating CVs for Metadyanamics, and all that remains are finding ways to approximate the leading eigenfunctions/eigenvectors. MSM and ICA are two methods that seek to approximate these eigenvectors, albeit with a differing choice of basis.
$\mathrm{tICA}^{15-17}$ is a kinetically motivated technique designed to find projections in the data that minimize loss of kinetic information by maximizing the autocorrelation function. Recall that high autocorrelation values imply slower structural degrees of freedom. In tICA, ${ }^{15,16}$ we seek to approximate $\psi_2$ by finding a linear combination of input structural order parameters that decorrelate the slowest at a particular lag time. These order parameters could be all of the backbone or side chain dihedrals or contact distances, etc. The complete derivation for the tICA formalism is outside the scope of this paper, but we briefly describe it using the notation from ref 15 . For a more complete derivation including tICA's connection to Transfer operator, we refer the readers to previous work. ${ }^{18,25,26}$ Let $\left\{\chi_t^d\right\}_{t=0}^{N_t-1}$ be a multidimensional MD time series where each frame is represented via a column of d-dimensions for a system. We further assume that the data has a mean of 0 . Then, tICA seeks to maximize the following function
$$
f\left(\left|a_1\right\rangle\right)=\frac{\mathbb{E}\left[\left\langle a_1 \mid \chi_t\right\rangle\left\langle a_1 \mid \chi_{t+\Delta t}\right\rangle\right]}{\mathbb{E}\left[\left\langle a_1 \mid \chi_t\right\rangle\left\langle a_1 \mid \chi_t\right\rangle\right]}
$$
where the maximization is over the autocorrelation function of the projection of the data onto $a_1$. By taking advantage of inner product symmetries, it can be then shown that
$$
f\left(\left|a_1\right\rangle\right)=\frac{\left\langle a_1|C(\Delta t)| a_1\right\rangle}{\left\langle a_1|\Sigma| a_1\right\rangle}
$$

Here, the symmetric matrix $C(\Delta t)$ is the time lagged correlation between the basis functions
$$
C_{i j}(\Delta t)=\mathbb{E}\left[\chi_t^i \cdot \chi_{t+\Delta t}^j\right]
$$
and $\Sigma$ is positive definite covariance matrix of the basis functions.
$$
\Sigma_{i j}=\mathbb{E}\left[\chi_t^i \cdot \chi_t^j\right]
$$

After applying unit variance constraints and setting up an optimization problem solvable via Langrage multipliers, it can be shown that $a_1$ (which is also the closest linear approximation to $\left.\psi_2\right)^{18}$ is the solution to the generalized eigenvalue problem
$$
C(\Delta t)\left|a_1\right\rangle=\lambda_1 \Sigma\left|a_1\right\rangle
$$

Subsequent projections, $a_2 \ldots a_d$, can be similarly found by requiring that the $a_n$ solution be uncorrelated with all solutions before it. An attractive property of the above formalism is that it generalizes to multiple orthogonal reaction coordinates (tICs), ordered by decreasing time scales. ${ }^{15,26}$ This quality can be harnessed to prevent slow convergence due to "hidden" orthogonal degrees of freedom by simultaneously sampling multiple tICs individually and connecting them via replica exchange.", 11 This means that if we accelerate the top " $m$ " tICs for $\mathrm{X}$-ns a piece such that $\mathrm{X}$ is larger than the time scale of the next $(m+1$ th $)$ tICs, then the system will naturally equilibrate and sample those additional degrees of freedom.

In practice, finding a set of slowest tICA components (tICs) requires the following steps. ${ }^{15,16}$
1. Run some $\mathrm{MD}$ simulations starting from all available crystal structures or homology models.
2. Pick a set of relevant structural order parameters (such as all the dihedrals or contacts or some combination thereof) to represent each frame of the trajectory. The choice of features remains but ICA can easily handle hundreds to thousands of order parameters, and we can pick the best set of features conditioned on available data via cross-validation. ${ }^{26}$
3. After picking a tICA lag time $\Delta t$, compute the symmetric matrix $C(\Delta t)$ and positive definite matrix $\sum$. Heuristically, we have found that ICA is robust to choices in the $1-100 \mathrm{~ns}$ range, though this parameter can be automatically chosen. ${ }^{26}$
4. Solve $C(\Delta t) \cdot a=\lambda \Sigma \cdot a$.
5. Pick the top few eigenvectors (tICs) with the largest eigenvalues.

Previously, the tICA method has been used as an intermediate dimensionality reduction step in MSM construction. ${ }^{15,16}$ Here, we add a final step to the recipe highlighted above.
6. Use Metadynamics to directly sample the slow degrees of freedom by using the tICs as CVs.

This is akin to using the principal components (PCs) $)^{21,24}$ but is more advantageous because we do not implicitly assume that the slow degrees of freedom correlate with high variance. ${ }^{15,24}$



This might happen in situations where the high variance modes might be movements within free-energy basins (see SI Figure 1 for a comparison of IICA vs PCA on alanine) rather than between them. We also note that our method is similar in spirit to the spectral gap maximization work of Tiwary et al., ${ }^{27}$ though we propose a simpler CV optimization strategy that can handle larger and more diverse feature inputs with realistic extensions to multiple nonlinear modes via the landmark approximation to the kernel trick ${ }^{28}$ and Bias-Exchange. ${ }^9$

Figure 1. tICA-Metadynamics for alanine dipeptide helps to converge simulations where only a few slow transitions have been observed. Clockwise from top a). Ramachandran plot of the long trajectory colored according to the projection of each frame unto the dominant tIC (arbitrary units). The dominant tIC corresponds to movement along both $(\psi)$ and $(\phi)$. The large yellow circle represents the starting frame for all simulations in this paper. b). Projection of the trajectory along the dominant tIC showing two slow transitions at $\sim 75$ and $\sim 120$ ns mark. c). The dominant tIC broken down according to its loadings on each input feature. Higher values indicate greater contribution to the slowest coordinate. See SI Figure 1 for a comparison to PCA. d). 15 ns Metadynamics run projected using (a). e). Projection of the Metadynamics simulation unto the tIC shows fast mixing. f). Comparison of the protein's thermodynamics from the MD (170 and $1800 \mathrm{~ns})$ vs tICA-Metadynamics approach. The lighter red curves indicate estimate of the free-energy surface after every 2000 Gaussians.

4. ##### TICA-METADYNAMICS ON ALANINE DIPEPTIDE LEADS TO FAST MIXING ALONG THE SLOWEST MODE

We end this paper by providing simple examples with solvated alanine dipeptide and bovine pancreatic trypsin inhibitor (BPTI). Alanine dipeptide has been previously used as an interesting model system in Metadynamics because the choice of faster CV $(\psi)$ leads to hysteresis and slow simulation convergence. Here, we show that not only the dominant IC is capable of finding a slow coordinate but also it does so in an unbiased fashion.

All MD trajectories were generated in the NPT ensemble with a MonteCarlo Barostat (1 atm), a Langevin integrator $(300 \mathrm{~K})$, and a $2 \mathrm{fs}$ time step. Long-range electrostatics were

modeled using the $\mathrm{PME}^{29}$ method. Protein dynamics were modeled using Amber99sb-ildn ${ }^{30}$ with the Tip3P water model. $^{31}$ All simulations, including the Metadynamics runs, were started from the same initial coordinates and velocities and were carried out on GPUs using OpenMM ${ }^5$ and Plumed. ${ }^{32}$ For all Metadynamics runs, we limited sampling to only the dominant (slowest) tIC unless specified otherwise. The Gaussians were dropped every $2 \mathrm{ps}$ with a height of $0.2 \mathrm{~kJ} /$ $\mathrm{mol}$ and a width of 0.1 (arb. tIC units). We also ran other trajectories where we increased the width and height of the Gaussians but found the results to be comparable. All IICA models were built using the sin-cosine transform of the backbone phi and psi dihedral angles at a tICA lag time of $1 \mathrm{~ns}$. All MSMs were built at a MSM lag time of $1 \mathrm{~ns}$ after clustering the data to 50 states along the dominant tIC. We used MDTraj (version 1.8) 33 and MSMBuilder3 (version 3.6.1) ${ }^{34}$ to build all tICA, cluster, and Markov state models. We used pyEMMA (version 2.2.7 $)^{35}$ for the MBAR $^{36}$ and WHAM ${ }^{37}$ calculations.

We began by generating a single $170 \mathrm{~ns}$ MD trajectory and building a tICA model to identify the slow dynamics within the system (Figure $1 \mathrm{a}-\mathrm{c}$ ). Our results indicate that the slowest transition happens on the order of $50-75 \mathrm{~ns}$ and corresponds to the movement from the $\beta / \alpha_R$ basins to the $\alpha_L$ basin (Figure la). This movement involves transitions along both the faster $\psi$ and slower $\phi$ coordinate (Figure 1c). Within the unbiased MD simulation, we observed just two such transitions (Figure lb), leading to large statistical uncertainties in the thermodynamics (Figure If, cyan curve). To complement this unbiased MD simulation, we sampled the tIC (starting from the same initial coordinates and velocities) using Metadynamics. Within the course of $15 \mathrm{~ns}$, we were able to witness the same transition on the order of tens of times, leading to robust free energy estimates for the two basins ( $\alpha_L$ vs $\alpha_R$ and $\beta$ ). For example, our simulation visited, defined as getting to a basin and continuously staying there for at least one frame $(10 \mathrm{ps})$, the $\alpha_L$ basin (tIC value >5) 185 times over the course of the $15 \mathrm{~ns}$ in contrast to two times over $170 \mathrm{~ns}$ of traditional MD, presenting a potential speed up of close to a $1000 \times$. It is worth noting that when we extended our regular $\mathrm{MD}$ simulations to an aggregate of $1800 \mathrm{~ns}$ (Figure 1f, gold curve) that the free energy difference between MSM and tICA-Metadynamics drops to less than $1 \mathrm{kcal} / \mathrm{mol}$, indicating synergistic opportunities between the techniques.

5. ####  TICA-METADYNAMICS ON ALANINE DIPEPTIDE CAN DRIVE TRANSITIONS ALONG THE SLOWEST MODE

We next investigated whether we could use the tICAMetadynamics method when no slow transitions occur in the data, but a tICA model is able to partially approximate the true time lagged correlation matrix and covariance matrix from simulations. This is reasonable because only a few data points are lost when we do not include the rare crossover region in the correlation calculation. We also note that this is a common problem for MD simulations in which the modeler has access to multiple starting crystal structures, but the free energy differences, the lowest free energy path connecting those states, or the knowledge of intermediate or off-pathway states remains elusive. For instance, in the case of alanine dipeptide, this would refer to the transition between $\beta / \alpha_R$ to the $\alpha_L$ basin (Figure lac) and is dominated by the slowly evolving $\phi$ dihedral.

To test our hypothesis, we sliced two $\sim 2$ ns ( $2.5 \%$ of original $170 \mathrm{~ns})$ worth of trajectories from the regular long simulation, taking care to prevent any crossovers between the $\beta$ and $\alpha_L$ basins (Figure $2 \mathrm{a}-\mathrm{c}$ ). We next trained a new tICA model (Figure 2c, partial MD tICA). Again, the dominant tIC corresponded to transitions in and out of the $\alpha_L$ basin, though the associated time scale is now meaningless. More importantly, when we performed Metadynamics along this coordinate, our simulation was able to cross from $\beta$ to the $\alpha_L$ basin. Due to the length of the simulations, our trajectories naturally discovered the $\alpha_R$ basin which is separated from the $\beta$ region by a much smaller barrier. We obtained $10 \mathrm{~s}$ of crossovers along the dominant mode in $\sim 15$ ns of simulation. Again, for example, our simulation visited the $\alpha_L$ basin (defined as IC value >0.6) 122 times over the course of the $15 \mathrm{~ns}$ in contrast to zero times in the $4 \mathrm{~ns}$ of training data.

 Figure 2. tICA-Metadynamics can drive alanine dipeptide simulations along slow coordinates even when no transitions are observed in the tICA training data. Clockwise from top a). Ramachandran plot of the subsections of the trajectory from Figure la colored according to the projection of each frame unto a new tICA model trained on the sliced trajectory data. The dominant tIC corresponds to movement along both $(\psi)$ and $(\phi)$ b). Projection of the trajectory along the dominant tIC showing no forward or backward transitions in the 4 ns of simulation. c). The dominant tIC broken down according to its loadings on each input feature. d). $15 \mathrm{~ns}$ Metadynamics run projected using (a). e). Projection of the Metadynamics simulation onto the partial MD tIC coordinate shows fast mixing. f). Comparison of the protein's thermodynamics from the partial MD vs tICAMetadynamics approach. The lighter red curves indicate estimate of the free-energy surface after every 2000 Gaussians. We explicitly note that this is a new tICA model and should not be numerically compared to the model from Figure 1 .

6. ##### TICA-METADYNAMICS CAN BE EXTENDED TO MULTIPLE COORDINATES BY EXPLOITING NONLINEARITY AND BIAS-**EXCHANGE**

It is possible that for larger more complex biophysical systems, no single linear combination of input features can provide a good approximation to the system’s slowest dynamics. This is a generic problem within most CV based enhanced sampling algorithms and is usually solved by using either alternative and/ or multiple CVs. In contrast, we propose using the kernel trick $^{28,38}$ to significantly improve tICA's ability to estimate the eigen functions of the transfer operator. ${ }^{28}$

Kernel methods ${ }^{24,28,39}$ are algorithms from ML literature. In these methods, the input features are implicitly expanded onto a higher dimensional space. This is done by computing the inner product between all pairs of data. In our case, this nonlinear transform is followed by linear ICA, making our final solution linear combinations of nonlinear functions. The most commonly used kernel is the Gaussian kernel
$$
k(x, y)=e^{-\|x-y\|^2 / 2 \sigma^2}
$$
where $x$ and $y$ are two protein conformations, and $\sigma$ is a user parameter that is dependent on the chosen distance metric. Thus, the slowest coordinate in our system is the linear combination of exponential distances that decorrelates the slowest. Here, the exponential function implicitly encodes nonlinear behavior. The full kernel operation would require us to compute the distance of any newly generated conformation to all of the previously generated training data points. Empirically, we found that the use of the complete kernel-tICA solution slowed down our Metadynamics simulations too much, and we thus were forced to use the landmark approximation. In it, the kernel $k(x, y)$ is only computed for a set of preselected landmark conformations in the unbiased MD data set. $^{40}$

To test out the landmark kernel-tICA-Metadynamics simulation protocol, we chose to look at the millisecond long simulation of 58-residue protein BPTI by Shaw et al. ${ }^4$ performed on the Anton machine. ${ }^3$ In their simulation, BPTI remains stable over the course of the $1 \mathrm{~ms}$ simulation save for a large scale conformational change occurring about $800 \mu$ s into the simulation. This high free energy state corresponds to the opening and hydrating of the protein's core. We tested if landmark-kernel-tICA could find a coordinate along which Metadynamics could accelerate this opening and closing. As a side note, we also tested whether tICA could find an approximation to the dominant IC coordinate without the need for full sampling by only building the models using data from the open and closed states (SI Figure 2), finding that ICA could distinguish between the basins using a variety of input features.

For our experiments on BPTI, the original Anton trajectories were subsampled to $25 \mathrm{~ns}$ for faster analysis. We used 50 landmark points (chosen by picking the centroids of a 50 state

clustering model) combined with the all atom RMSD distance metric and a $\sigma$ value of $0.3 \mathrm{~nm}$. It is worth noting here that the all atom RMSD landmark kernel ICA solution operates in the full-phase space and is free from many of the problems that plague traditionally selected CVs. Similar to previous work, ${ }^{42}$ our IICA experiments with other ICA parameters and distance metrics led to the discovery of kinetically disconnected data sets, indicating the need for validating the ICA model before performing ICA-Metadynamics. We believe this process could be a force field or sampling artifact and chose to focus on the results of the all atom RMSD metric that correctly described the opening of the protein core. The ICA model was built using all of the available data at a lag time of $100 \mathrm{~ns}$ (4 frames) and using the kinetic mapping ${ }^{17}$ scaling. We projected the data onto the top five slow modes (Figure 3a-b).

The results of projecting the entire $1 \mathrm{~ms}$ Anton simulation onto the five tICs are shown in Figure $3 b$. The nonlinear landmark kernel tICA model captures the large scale conformational change (Figure $3 \mathrm{~d}$ ) in the protein (low to high values in Figure $3 \mathrm{~b}$, top panel). We decided to accelerate the sampling of this process by performing Bias-Exchange ${ }^9$ well-tempered Metadynamics along the five tICA coordinates. In welltempered Metadynamics, ${ }^{10}$ the Gaussian heights are scaled as the simulation progresses leading to a smoothly converged free energy profile. In Bias-Exchange ${ }^{9,11,43}$ Metadynamics, several coordinates are accelerated at once, and at set simulation times the coordinates are swapped according to a Monte Carlo criterion.

All of our BPTI simulations were performed in the NPT ensemble using the Amber99sb-ildn ${ }^{30}$ protein model in conjunction with the TIP3P ${ }^{31}$ water model. We ran each replica for $\sim 140 \mathrm{~ns}$ attempting swaps every $6 \mathrm{ps}$. We set the Gaussian drop rate to once per $2 \mathrm{ps}$, the Gaussian height was set to $1 \mathrm{~kJ} / \mathrm{mol}$, the width was set to 0.2 , and a bias factor consisted of 1000. As shown in the results for the first ICMetadynamics replica (Figure 3c), we were able to accelerate BPTI's opening and closing rather significantly, capturing many core opening events.

It is possible that for more complex systems kernel-tICA proves insufficient. For example, for BPTI, there are still several tIC coordinates whose exchange time scales are on the order of hundreds of nanoseconds (Figure $3 a$, indices $>5$ ). It is likely given the length of our trajectories that our simulations did not adequately sample those dimensions (SI Figure 3), and we will need to further extend the Metadynamics simulations. In such scenarios, we recommend accelerating the system along all tICA coordinates whose inferred time scales are greater than the simulation length of any single replica. These trajectories can then be reweighted unto full state space using the weighted histogram technique (WHAM) $)^{43,49}$ or multistate Bennett Acceptance Ratio (MBAR). ${ }^{36}$ This is highly desirable in situations where one would like to estimate the free energies along coordinates that were not biased in the simulation. The SI contains an example of alanine dipeptide where we used nonlinear tICA in conjunction with Bias-Exchange welltempered Metadynamics to accelerate the top two slow modes, reweighted the trajectories unto full phase space using MBAR, and compared the results against several microseconds of regular MD.

To conclude, we propose using the tICA method from the MSM literature as an unbiased way for discovering Metadynamics CVs (tICA-Metadynamics). This is superior to MLbased or heuristic engineering because IICA, by construction,attempts to find the slowest decorrelating combination of input structural order parameters. We further show that even in the low data regime, tICA's approximate solution can provide CVs for Metadynamics.

It is worth noting some limitations of tICA-Metadynamics. In the examples where we would like to complement the MSM's estimates of thermodynamics and kinetics, ${ }^2$ we require unbiased sampling of the slow transitions via $\mathrm{MD}$. This might require hundreds of microseconds of aggregate MD sampling, making it unfeasible for all but the smallest systems. In the incomplete $\mathrm{MD}$ case, where we would like to drive the transition along the slowest tICs, we assume that enough MD is run starting from high and low free energy states that the ICA model is able to approximate the time lagged correlation function. Depending on the system, this might be very difficult; for example, the proper rank ordering of the set of slowest coordinates might not be possible. In both cases, the choice of the number of ICA coordinates to accelerate remains. While the kernel extension and simultaneously accelerating along multiple coordinates can greatly attenuate the situation, convergence will likely require sampling of all tICA coordinates whose exchange time scales are slower than the individual simulation lengths and coupled to one another via a replica scheme. Lastly, we inherently assume that the tICs are biologically meaningful and not an artifact of improper choice of basis, sampling, and/or force field inaccuracies. ${ }^{18}$

Before we end, we note that while we have limited our results to improving CV selection for Metadynamics simulations, it is possible to use this method to find better CVs for other enhanced sampling methods as well. For example, it is entirely possible to directly sample these tICs using Umbrella sampling ${ }^{19,20}$ or its variants. It could also be possible to couple the tICs to differing thermostats similar to temperatureaccelerated MD. ${ }^{50,51}$ The latter method could potentially allow for the use of a larger number of tICs though reconstructing the exact free energy surface in that case is an unsolved problem. We also note that while we have used two of the main variants of ICA, other approximations and improvements $^{17,18}$ exist that might be better suited for tICAMetadynamics.

Importantly, the use of leading eigenvectors of the transfer operator as CVs opens up interesting avenues for further research. Could we potentially use the full MSM state-space as the driving force for Metadynamics, allowing us to integrate out the arduous problem of selecting CVs completely? The kernel tICA example partially solves this problem but suffers from the need for selection of representative landmark coordinates. On the Metadynamics side, could having partial or complete knowledge of the MSM free energy landscape help to accelerate convergence or reduce the number of researcher degrees of freedom such as the Gaussian width, shape, and drop rate? Could we potentially use the ICA coordinates from coarse grained simulations for atomistic simulations or vice versa? We anticipate that these questions could provide interesting avenues for future research into directly coupling reaction coordinate based methods with enhanced sampling algorithms.

Figure 3. Accelerating BPTI along its slow modes enables efficient sampling of the opening and closing of the protein's core. a). Inferred exchange time scales for the nonlinear tICA model. We limited Metadynamics sampling to the top 5 modes (dashed line). b). Projection of the $1 \mathrm{~ms}$ Anton trajectory unto the top 5 modes. The horizontal marks at the start correspond to the projection of the 50 pdbs that served as the landmark coordinates. The opening of the protein core corresponds to the large scale motion at about $800 \mu \mathrm{s}$ mark. c). Projection of $140 \mathrm{~ns}$ of one of the Metadynamics trajectories showing that this motion can be repeatedly sampled by employing nonlinear IICA and bias exchange. d). Pictorial representation of the first tIC primarily corresponding to outward movement of the $\mathrm{N}$-terminal loop. The protein image was generated using $\mathrm{VMD},{ }^{44}$ the secondary structure was assigned using STRIDE, ${ }^{45}$ and graphs were made using Matplotlib, ${ }^{46}$ IPython, $^{47}$ MSMBuilder, and MSMExplorer. ${ }^{48}$

